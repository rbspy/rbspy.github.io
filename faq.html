<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>FAQ - rbspy: A Sampling CPU Profiler for Ruby</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="installing.html"><strong aria-hidden="true">2.</strong> Installing</a></li><li class="chapter-item expanded "><a href="using-rbspy/index.html"><strong aria-hidden="true">3.</strong> Using rbspy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="using-rbspy/snapshot.html"><strong aria-hidden="true">3.1.</strong> snapshot</a></li><li class="chapter-item expanded "><a href="using-rbspy/record.html"><strong aria-hidden="true">3.2.</strong> record</a></li><li class="chapter-item expanded "><a href="using-rbspy/report.html"><strong aria-hidden="true">3.3.</strong> report</a></li></ol></li><li class="chapter-item expanded "><a href="rbspy-vs-stackprof.html"><strong aria-hidden="true">4.</strong> rbspy vs stackprof</a></li><li class="chapter-item expanded "><a href="profiling-guide/index.html"><strong aria-hidden="true">5.</strong> Profiling guide</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="profiling-guide/questions-to-ask.html"><strong aria-hidden="true">5.1.</strong> Questions to ask</a></li><li class="chapter-item expanded "><a href="profiling-guide/benchmarking-your-code.html"><strong aria-hidden="true">5.2.</strong> Benchmarking your code</a></li><li class="chapter-item expanded "><a href="profiling-guide/using-flamegraphs.html"><strong aria-hidden="true">5.3.</strong> Using flamegraphs</a></li></ol></li><li class="chapter-item expanded "><a href="getting-help.html"><strong aria-hidden="true">6.</strong> Getting help</a></li><li class="chapter-item expanded "><a href="contributing.html"><strong aria-hidden="true">7.</strong> Contributing</a></li><li class="chapter-item expanded "><a href="faq.html" class="active"><strong aria-hidden="true">8.</strong> FAQ</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">rbspy: A Sampling CPU Profiler for Ruby</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rbspy/rbspy.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="frequently-asked-questions"><a class="header" href="#frequently-asked-questions">Frequently asked questions</a></h1>
<h2 id="who-makes-rbspy"><a class="header" href="#who-makes-rbspy">Who makes rbspy?</a></h2>
<p><a href="https://jvns.ca">Julia Evans</a> started the project and led its development until 2021.
<a href="https://acj.sh">Adam Jensen</a> is the primary maintainer. For a full list of contributors,
see the <a href="https://github.com/rbspy/rbspy/blob/main/CONTRIBUTORS.md">CONTRIBUTORS file</a>.</p>
<h2 id="who-funds-rbspy"><a class="header" href="#who-funds-rbspy">Who funds rbspy?</a></h2>
<p>Initial rbspy development was funded by <a href="https://segment.com/blog/segment-open-fellowship-2017/">the Segment Open Fellowship</a> -- they paid for 3 months of
development on the project, to take it from a sketchy prototype to an actual working profiler that
people use to make their Ruby programs faster. Julia took a 3 month sabbatical off work to build it.</p>
<p>This kind of short-term funding is an awesome way to bootstrap new open source projects that might
not happen otherwise! You can do a lot in 3 months :)</p>
<h2 id="can-i-use-rbspy-in-production"><a class="header" href="#can-i-use-rbspy-in-production">Can I use rbspy in production?</a></h2>
<p>Yes! rbspy only reads memory from the Ruby process you're monitoring, it doesn't make any changes.
Unlike some other statistical profilers, rbspy does <strong>not</strong> use signals or ptrace, so it won't
interrupt system calls your Ruby program is making.</p>
<p>The things to be aware of are:</p>
<ul>
<li>By default, <code>rbspy</code> 0.6 and newer pauses the ruby process when it's collecting samples. This can
affect performance, especially if you're using a high sampling rate. You can disable the pausing
with the <code>--nonblocking</code> flag, but be aware that this can lead to incorrect samples.</li>
<li><code>rbspy</code> does use some CPU. If you use <code>rbspy record --subprocesses</code>, it can use a substantial
amount of CPU (because it'll start a separate thread for every process it's recording)</li>
<li>disk usage: <code>rbspy record</code> will save a data file to disk with compressed stack traces, and if you
run it for many hours it's possible you'll use a lot of disk space. We recommend giving rbspy a
time limit, like <code>rbspy record --duration 10</code>.</li>
</ul>
<p>Any bugs in rbspy will manifest as rbspy crashing, not your Ruby program crashing.</p>
<h2 id="how-does-rbspy-read-data-from-my-ruby-processes"><a class="header" href="#how-does-rbspy-read-data-from-my-ruby-processes">How does rbspy read data from my Ruby processes?</a></h2>
<p>On Linux, it uses the <code>process_vm_readv</code> system call, which lets you read memory from any other
running process.</p>
<h2 id="how-does-rbspy-handle-threads"><a class="header" href="#how-does-rbspy-handle-threads">How does rbspy handle threads?</a></h2>
<p><code>rbspy</code> always collects the stack from what the Ruby VM reports as the currently running thread.
This is because the global VM lock (GVL) only allows one thread to be running Ruby code at any given time. It ignores
threads that are not currently running.</p>
<p>When rbspy is profiling ruby 3 programs, it currently only samples the main ractor.</p>
<h2 id="can-rbspy-profile-c-extensions"><a class="header" href="#can-rbspy-profile-c-extensions">Can rbspy profile C extensions?</a></h2>
<p>Yes. Any calls into C will be reported in the format &quot;sleep [c function] - (unknown)&quot;.</p>
<h2 id="i-love-rbspy-how-can-i-thank-you"><a class="header" href="#i-love-rbspy-how-can-i-thank-you">I love rbspy! How can I thank you?</a></h2>
<p>It really helps if you add a comment to our <a href="https://github.com/rbspy/rbspy/issues/62">list of testimonials on GitHub</a> saying how rbspy helped you!</p>
<h2 id="is-there-a-similar-project-for-python"><a class="header" href="#is-there-a-similar-project-for-python">Is there a similar project for Python?</a></h2>
<p>Yes! <a href="https://github.com/benfred/py-spy">py-spy</a> by <a href="https://www.benfrederickson.com/">Ben Frederickson</a> and <a href="https://github.com/uber/pyflame">pyflame</a> by <a href="https://eklitzke.org/">Evan Klitzke</a> do
basically the same thing as rbspy, but for Python programs.</p>
<h2 id="who-made-the-logo"><a class="header" href="#who-made-the-logo">Who made the logo?</a></h2>
<p><a href="https://twitter.com/ashleymcnamara">Ashley McNamara</a> was extremely kind and designed it!! She's an
awesome software engineer who also makes delightful stickers. See her 
<a href="https://github.com/ashleymcnamara/gophers">gophers repository</a> for a bunch of awesome gopher art she's done
for the Go community.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="contributing.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="contributing.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
